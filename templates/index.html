<!DOCTYPE html>
<html>
<head>
    <title>Ujian AI: Deteksi Semangka</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background-color: #f0f2f5; }
        h1 { color: #2c3e50; }
        .container { display: flex; justify-content: center; gap: 20px; margin-top: 20px; }
        .box { background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); width: 400px;}
        img { max-width: 100%; border-radius: 4px; margin-top: 10px; min-height: 200px; background: #eee; }
        button { background-color: #27ae60; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin-top: 20px;}
        button:hover { background-color: #219150; }
    </style>
</head>
<body>

    <h1>üçâ AI Watermelon Detector</h1>
    <p>Upload gambar semangka, AI akan mendeteksinya.</p>

    <input type="file" id="uploadInput" accept="image/*">
    <br>
    <button onclick="detectWatermelon()">üîç Deteksi Sekarang</button>

    <div class="container">
        <div class="box">
            <h3>Gambar Asli</h3>
            <img id="previewImg" alt="Preview akan muncul disini">
        </div>
        <div class="box">
            <h3>Hasil Deteksi AI</h3>
            <img id="resultImg" alt="Hasil akan muncul disini">
        </div>
    </div>

    <script>
        let selectedFile = null;

        document.getElementById('uploadInput').addEventListener('change', function(e) {
            selectedFile = e.target.files[0];
            if (selectedFile) {
                document.getElementById('previewImg').src = URL.createObjectURL(selectedFile);
                document.getElementById('resultImg').src = ""; // Reset hasil lama
            }
        });

        async function detectWatermelon() {
            if (!selectedFile) {
                alert("Mohon pilih gambar semangka dulu!");
                return;
            }

            let formData = new FormData();
            formData.append("image", selectedFile);

            // Tampilkan loading (opsional)
            document.getElementById('resultImg').style.opacity = 0.5;

            try {
                let response = await fetch('/detect', {
                    method: "POST",
                    body: formData
                });

                if (response.ok) {
                    let blob = await response.blob();
                    document.getElementById('resultImg').src = URL.createObjectURL(blob);
                } else {
                    alert("Gagal mendeteksi. Cek terminal untuk error.");
                }
            } catch (err) {
                alert("Terjadi kesalahan koneksi.");
            } finally {
                document.getElementById('resultImg').style.opacity = 1;
            }
        }
    </script>
</body>
</html>